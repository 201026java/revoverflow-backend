<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../../jacoco-resources/report.gif" type="image/gif"/><title>LoginControllerTests.java</title><link rel="stylesheet" href="../../../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../../../index.html" class="el_report">project-3-back-end (Jul 22, 2020 12:16:10 PM)</a> &gt; <a href="../../index.html" class="el_group">project-3-back-end</a> &gt; <a href="../index.html" class="el_bundle">src/test/java</a> &gt; <a href="index.source.html" class="el_package">com.revature.controllers</a> &gt; <span class="el_source">LoginControllerTests.java</span></div><h1>LoginControllerTests.java</h1><pre class="source lang-java linenums">package com.revature.controllers;

import static org.junit.Assert.assertEquals;
import static org.junit.Assert.assertFalse;
import static org.junit.Assert.assertNotEquals;
import static org.junit.Assert.assertTrue;
import static org.springframework.security.test.web.servlet.setup.SecurityMockMvcConfigurers.springSecurity;

import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.mockito.Mock;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.autoconfigure.web.servlet.AutoConfigureMockMvc;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.http.MediaType;
import org.springframework.test.context.ContextConfiguration;
import org.springframework.test.context.junit4.SpringRunner;
import org.springframework.test.web.servlet.MockMvc;
import org.springframework.test.web.servlet.MvcResult;
import org.springframework.test.web.servlet.request.MockMvcRequestBuilders;
import org.springframework.test.web.servlet.setup.MockMvcBuilders;
import org.springframework.web.context.WebApplicationContext;

import com.fasterxml.jackson.databind.ObjectMapper;
import com.revature.Application;
import com.revature.DTOs.RSSUserDTO;
import com.revature.services.RSSService;

@RunWith(SpringRunner.class)
@ContextConfiguration
@SpringBootTest(
		webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT,
		classes = Application.class)
@AutoConfigureMockMvc
<span class="fc" id="L36">public class LoginControllerTests {</span>
	static RSSUserDTO u1, u2, u3;

	@Autowired
	private WebApplicationContext context;
	
	@Autowired 
	private ObjectMapper mapper;
	
	@Mock
	RSSService rssService;
	
	@Autowired                           
    private MockMvc mockMvc;  
	
	@Before                          
    public void setUp() {  
<span class="fc" id="L53">	   u1 = new RSSUserDTO(&quot;test@email.com&quot;,&quot;12345&quot;);</span>
<span class="fc" id="L54">       u2 = new RSSUserDTO(&quot;keirss&quot;,null);</span>
<span class="fc" id="L55">       u3 = new RSSUserDTO(&quot;user@rss.com&quot;, &quot;Password123!&quot;);</span>
<span class="fc" id="L56">   	   mockMvc = MockMvcBuilders</span>
<span class="fc" id="L57">   				.webAppContextSetup(context)</span>
<span class="fc" id="L58">   				.apply(springSecurity())</span>
<span class="fc" id="L59">   				.build();</span>
<span class="fc" id="L60">    }</span>
	
	@Test
    public void will_return_user_with_a_status_of_200_and_them_to_our_database() throws Exception {
<span class="fc" id="L64">		String user = mapper.writeValueAsString(u1);</span>
<span class="fc" id="L65">    	MvcResult result = mockMvc.perform(MockMvcRequestBuilders.post(&quot;/login&quot;)</span>
<span class="fc" id="L66">    			.contentType(MediaType.APPLICATION_JSON_UTF8)</span>
<span class="fc" id="L67">    			.content(user)</span>
<span class="fc" id="L68">    			.accept(MediaType.APPLICATION_JSON_UTF8)</span>
<span class="fc" id="L69">    			).andReturn();</span>
<span class="fc" id="L70">    			String content = result.getResponse().getContentAsString();</span>
<span class="fc" id="L71">    			assertEquals(200, result.getResponse().getStatus());</span>
<span class="fc" id="L72">    			assertTrue(&quot;This return object conains the string&quot;, content.contains(&quot;jwt&quot;));</span>
<span class="fc" id="L73">    			assertNotEquals(null, content);</span>
<span class="fc" id="L74">    }</span>
	@Test
    public void will_not_return_no_user_with_a_status_of_200_and_no_jwtToken() throws Exception {
<span class="fc" id="L77">		String user1 = mapper.writeValueAsString(u2);</span>
<span class="fc" id="L78">    	MvcResult result = mockMvc.perform(MockMvcRequestBuilders.post(&quot;/login&quot;)</span>
<span class="fc" id="L79">    			.contentType(MediaType.APPLICATION_JSON_UTF8)</span>
<span class="fc" id="L80">    			.content(user1)</span>
<span class="fc" id="L81">    			.accept(MediaType.APPLICATION_JSON_UTF8)</span>
<span class="fc" id="L82">    			).andReturn();</span>
<span class="fc" id="L83">    			String content = result.getResponse().getContentAsString();</span>
<span class="fc" id="L84">    			System.out.println(content+ &quot;\n&quot; +  result.getResponse().getStatus());</span>
<span class="fc" id="L85">    			assertEquals(200, result.getResponse().getStatus());</span>
<span class="fc" id="L86">    			assertFalse(&quot;This return object conains no token&quot;, content.contains(&quot;jwt&quot;));</span>
<span class="fc" id="L87">    			assertEquals(&quot;&quot;, content);</span>
<span class="fc" id="L88">    }</span>
	@Test
    public void will_return_user_with_a_status_of_200() throws Exception {
<span class="fc" id="L91">		String user = mapper.writeValueAsString(u3);</span>
<span class="fc" id="L92">    	MvcResult result = mockMvc.perform(MockMvcRequestBuilders.post(&quot;/login&quot;)</span>
<span class="fc" id="L93">    			.contentType(MediaType.APPLICATION_JSON_UTF8)</span>
<span class="fc" id="L94">    			.content(user)</span>
<span class="fc" id="L95">    			.accept(MediaType.APPLICATION_JSON_UTF8)</span>
<span class="fc" id="L96">    			).andReturn();</span>
<span class="fc" id="L97">    			String content = result.getResponse().getContentAsString();</span>
<span class="fc" id="L98">    			assertEquals(200, result.getResponse().getStatus());</span>
<span class="fc" id="L99">    			assertTrue(&quot;This return object conains the string&quot;, content.contains(&quot;jwt&quot;));</span>
<span class="fc" id="L100">    			assertNotEquals(null, content);</span>
<span class="fc" id="L101">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.5.201910111838</span>project-3-back-end (Jul 22, 2020 12:16:10 PM)</div></body></html>